function Wikipedia(){var e=this;this.url_article="http://en.wikipedia.org/w/api.php?action=query&prop=extracts&format=json&exlimit=10&redirects&titles=",this.url_image="http://en.wikipedia.org/w/api.php?action=query&redirects&generator=images&gimlimit=20&prop=imageinfo&iiprop=url|dimensions|mime&format=json&titles=",this.article=function(t,n,i){var r=this._get_good_names([t,n]),o=e._build_urls(r,e._makeArticleUrl);e._makeRequestUntilGoodContent(o,e.processArticle,e._ArticleHasGoodContent,i)},this.image=function(t,n,i){var r=this._get_good_names([t,n]),o=e._build_urls(r,e._makeImageUrl);e._makeRequestUntilGoodContent(o,e.process_image,e._imageHasGoodContent,i)},this.processArticle=function(t){var n=t.query.pages,i=e._getContentKeys(n);return e._isNoContent(i,n)?void console.info("No result for article."):n[i[0]]},this.process_image=function(e){if(_.isUndefined(e.query)||_.isUndefined(e.query.pages))return void 0;var t=e.query.pages,n=_.keys(t).sort(function(e,t){return e-t});return _.map(n,function(e){return t[e]})},this._getContentKeys=function(e){var t=_.keys(e);return _.filter(t,function(t){return-1!==t&&_.isDefined(e[t].extract)})},this._isNoContent=function(e,t){return 0===e.length&&_.isDefined(t[-1])&&""===t[-1].missing},this._ArticleHasGoodContent=function(e){return _.isUndefined(e)||_.isUndefined(e.extract)?!1:-1!==e.extract.indexOf("may refer")?!1:!0},this._imageHasGoodContent=function(e){return!_.isUndefined(e)},this._get_good_names=function(e){var t=_.select(e,_.identity);return _.unique(t)},this._build_urls=function(e,t){return _.map(e,t)},this._makeArticleUrl=function(t){return encodeURI(e.url_article+t+"&callback=?")},this._makeImageUrl=function(t){return encodeURI(e.url_image+t+"&callback=?")},this._makeRequestUntilGoodContent=function(t,n,i,r){if(0===t.length)return void r(void 0);var o=t[0];this._makeRequest(o,function(o){var a=n(o);i(a)?r(a):e._makeRequestUntilGoodContent(_.tail(t),n,i,r)})},this._makeRequest=function(e,t){$.getJSON(e,t)}}
